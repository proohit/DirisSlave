plugins {
    id 'java'
    id 'application'
    id 'war'
}

application {
    mainClass = 'main.Startup'
}

group 'org.example'
version '0.0.1'

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(15)
    }
}

repositories {
    mavenCentral()
    maven {
        name 'm2-dv8tion'
        url 'https://m2.dv8tion.net/releases'
    }
    maven{
        url = uri("https://dl.bintray.com/sedmelluq/com.sedmelluq")
    }
}


dependencies {
    implementation 'com.sedmelluq:lavaplayer:1.3.76'
    implementation'net.dv8tion:JDA:4.2.1_253'
    implementation 'com.google.code.gson:gson:2.8.6'
    implementation 'org.jfree:jfreechart:1.0.14'
    implementation group: 'mysql', name: 'mysql-connector-java', version: '8.0.24'
    implementation 'com.konghq:unirest-java:3.11.05'
    implementation 'com.github.mpkorstanje:simmetrics-core:4.1.1'
    implementation 'org.tinylog:tinylog-api:2.3.0-M1'
    implementation 'org.tinylog:tinylog-impl:2.3.0-M1'
    implementation 'com.zaxxer:HikariCP:4.0.3'
    implementation "org.jooq:jooq:3.14.9"
    implementation "org.jooq:jooq-meta:3.14.8"
    implementation "org.jooq:jooq-codegen:3.14.8"
    implementation group: 'org.springframework.boot', name: 'spring-boot-starter-web', version: '2.4.5'

}

def generatedVersionDir = "${buildDir}/generated-version"

sourceSets {
    main {
        output.dir(generatedVersionDir, builtBy: 'generateVersionProperties')
    }
}

task generateVersionProperties {
    doLast {
        def propertiesFile = file "$generatedVersionDir/version.properties"
        propertiesFile.parentFile.mkdirs()
        def properties = new Properties()
        properties.setProperty("version", rootProject.version.toString())
        propertiesFile.withWriter { properties.store(it, null) }
    }
}
processResources.dependsOn generateVersionProperties